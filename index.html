<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextFlame - Find Your Vibe</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #18191a; color: #e4e6eb; line-height: 1.5; }
        
        /* Landing Page */
        .landing { min-height: 100vh; background: linear-gradient(125deg, #0a0a0f, #1a0a20, #0f1a2a, #1a0a20, #0a0a0f); background-size: 400% 400%; animation: grad 15s ease infinite; display: flex; align-items: center; justify-content: center; padding: 20px; }
        @keyframes grad { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        .landing-content { max-width: 1200px; width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: center; }
        .landing-logo { font-size: 64px; font-weight: bold; background: linear-gradient(135deg, #f5576c, #ff8c42, #ffd700); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; }
        .landing-tagline { font-size: 28px; color: rgba(255, 255, 255, 0.9); line-height: 1.4; }
        .landing-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 40px; }
        .landing-card h2 { font-size: 32px; margin-bottom: 10px; background: linear-gradient(135deg, #f5576c, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .landing-btn { width: 100%; padding: 16px; font-size: 18px; font-weight: 600; border: none; border-radius: 8px; background: linear-gradient(135deg, #f5576c, #8b5cf6); color: white; cursor: pointer; transition: transform 0.2s; }
        .landing-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(245, 87, 108, 0.5); }
        .landing-features { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
        .landing-feature { padding: 12px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; text-align: center; font-size: 14px; }
        
        /* Facebook Layout */
        .fb-layout { min-height: 100vh; }
        .hidden { display: none !important; }
        
        /* Top Nav */
        .fb-topnav { position: fixed; top: 0; left: 0; right: 0; height: 56px; background: rgba(26, 10, 32, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(245, 87, 108, 0.2); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; z-index: 1000; }
        .fb-topnav-left { display: flex; align-items: center; gap: 12px; flex: 1; }
        .fb-logo { font-size: 28px; font-weight: bold; background: linear-gradient(135deg, #f5576c, #ff8c42); -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; }
        .fb-search input { width: 240px; padding: 10px 12px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 20px; color: #e4e6eb; font-size: 14px; }
        .fb-topnav-center { display: flex; gap: 8px; }
        .fb-nav-icon { position: relative; width: 112px; height: 48px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 8px; transition: background 0.2s; }
        .fb-nav-icon:hover { background: rgba(255, 255, 255, 0.1); }
        .fb-nav-icon.active { border-bottom: 3px solid #f5576c; }
        .fb-nav-icon span { font-size: 24px; }
        .fb-badge { position: absolute; top: 8px; right: 8px; background: #f5576c; color: white; font-size: 11px; font-weight: bold; padding: 2px 6px; border-radius: 10px; min-width: 18px; text-align: center; }
        .fb-topnav-right { display: flex; align-items: center; gap: 12px; flex: 1; justify-content: flex-end; }
        .fb-credits { background: linear-gradient(135deg, #ffd700, #ff8c00); padding: 6px 14px; border-radius: 16px; font-weight: 600; color: #000; font-size: 14px; }
        .fb-profile-menu { position: relative; }
        .fb-profile-menu:hover .fb-dropdown { display: block; }
        .fb-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold; cursor: pointer; border: 2px solid rgba(245, 87, 108, 0.5); }
        .fb-dropdown { display: none; position: absolute; top: 50px; right: 0; background: rgba(36, 37, 38, 0.98); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; min-width: 200px; z-index: 1001; }
        .fb-dropdown-item { padding: 12px 16px; cursor: pointer; transition: background 0.2s; font-size: 14px; }
        .fb-dropdown-item:hover { background: rgba(255, 255, 255, 0.1); }
        
        /* Main Layout */
        .fb-main { display: flex; padding-top: 56px; }
        
        /* Left Sidebar */
        .fb-sidebar-left { position: fixed; left: 0; top: 56px; width: 280px; height: calc(100vh - 56px); overflow-y: auto; padding: 12px 8px; background: #18191a; border-right: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-sidebar-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s; font-size: 15px; font-weight: 500; }
        .fb-sidebar-item:hover { background: rgba(255, 255, 255, 0.1); }
        .fb-sidebar-icon { font-size: 24px; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.05); border-radius: 50%; }
        
        /* Center Content */
        .fb-content { flex: 1; max-width: 680px; margin: 0 auto; padding: 20px 16px; margin-left: 280px; margin-right: 360px; }
        
        /* Right Sidebar */
        .fb-sidebar-right { position: fixed; right: 0; top: 56px; width: 360px; height: calc(100vh - 56px); overflow-y: auto; padding: 20px 16px; background: #18191a; border-left: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-widget { background: rgba(255, 255, 255, 0.03); border-radius: 8px; padding: 16px; margin-bottom: 16px; border: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-widget h3 { font-size: 16px; font-weight: 600; margin-bottom: 12px; }
        .fb-friend-suggestion { display: flex; align-items: center; gap: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-avatar-sm { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold; }
        .fb-friend-name { font-size: 14px; font-weight: 600; flex: 1; }
        
        /* Cards */
        .fb-card { background: rgba(255, 255, 255, 0.03); border-radius: 8px; padding: 16px; margin-bottom: 16px; border: 1px solid rgba(255, 255, 255, 0.05); }
        
        /* Post Composer */
        .fb-composer-top { display: flex; gap: 12px; margin-bottom: 12px; }
        .fb-composer-input { flex: 1; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 12px 16px; color: #e4e6eb; font-size: 15px; resize: none; min-height: 40px; }
        .fb-composer-bottom { display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid rgba(255, 255, 255, 0.05); }
        
        /* Posts */
        .fb-post { padding: 12px 16px; }
        .fb-post-header { display: flex; gap: 12px; margin-bottom: 12px; }
        .fb-post-author { font-size: 15px; font-weight: 600; }
        .fb-post-time { font-size: 13px; color: rgba(255, 255, 255, 0.5); }
        .fb-post-content { font-size: 15px; margin-bottom: 12px; }
        .fb-post-stats { display: flex; justify-content: space-between; padding: 8px 0; font-size: 13px; color: rgba(255, 255, 255, 0.5); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-post-actions { display: flex; padding: 4px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .fb-post-action { flex: 1; padding: 8px; background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 14px; font-weight: 600; cursor: pointer; border-radius: 4px; }
        .fb-post-action:hover { background: rgba(255, 255, 255, 0.1); }
        .fb-post-action.active { color: #f5576c; }
        
        /* Comments */
        .fb-comment { display: flex; gap: 8px; margin: 12px 0; }
        .fb-comment-content { flex: 1; background: rgba(255, 255, 255, 0.05); border-radius: 18px; padding: 8px 12px; }
        .fb-comment-author { font-size: 13px; font-weight: 600; }
        .fb-comment-text { font-size: 14px; }
        .fb-comment-input { flex: 1; padding: 8px 12px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 18px; color: #e4e6eb; }
        
        /* Profile */
        .fb-cover { height: 320px; background: linear-gradient(125deg, #1a0a20, #0f1a2a, #1a0a20); position: relative; }
        .fb-profile-avatar { position: absolute; top: -80px; left: 32px; width: 168px; height: 168px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; font-size: 64px; border: 4px solid #18191a; }
        .fb-profile-header { position: relative; padding: 0 32px 16px; background: rgba(255, 255, 255, 0.03); }
        .fb-profile-info { padding-top: 100px; }
        .fb-profile-tabs { display: flex; padding: 0 32px; background: rgba(255, 255, 255, 0.03); }
        .fb-profile-tab { padding: 16px 20px; font-size: 15px; font-weight: 600; cursor: pointer; color: rgba(255, 255, 255, 0.6); border-bottom: 3px solid transparent; }
        .fb-profile-tab.active { color: #f5576c; border-bottom-color: #f5576c; }
        
        /* Buttons */
        .fb-btn-primary { padding: 8px 16px; background: linear-gradient(135deg, #f5576c, #8b5cf6); color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; }
        .fb-btn-primary:hover { transform: translateY(-1px); }
        .fb-btn-secondary { padding: 8px 16px; background: rgba(255, 255, 255, 0.1); color: #e4e6eb; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; font-size: 14px; cursor: pointer; }
        
        /* Modal */
        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.85); display: flex; align-items: center; justify-content: center; z-index: 2000; }
        .modal-content { background: rgba(36, 37, 38, 0.98); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 32px; max-width: 500px; width: 90%; position: relative; }
        .modal-close { position: absolute; top: 16px; right: 16px; background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 32px; cursor: pointer; }
        .modal-content h2 { font-size: 24px; margin-bottom: 24px; text-align: center; }
        .modal-content input, .modal-content select, .modal-content textarea { width: 100%; padding: 10px 12px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 8px; color: #e4e6eb; font-size: 14px; margin-bottom: 12px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        
        /* Responsive */
        @media (max-width: 1280px) { .fb-sidebar-right { display: none; } .fb-content { margin-right: 0; } }
        @media (max-width: 900px) { .fb-sidebar-left { display: none; } .fb-content { margin-left: 0; } .landing-content { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div id="app"></div>

<script>
const FE = 'tannerkurrasch@gmail.com';
const vi = {gamer: 'üéÆ', stoner: 'üåø', artist: 'üé®', nerd: 'ü§ì'};
let me = null;
let view = 'feed';
let DB = {
    users: JSON.parse(localStorage.getItem('nf_users') || '[]'),
    posts: JSON.parse(localStorage.getItem('nf_posts') || '[]'),
    friendReqs: JSON.parse(localStorage.getItem('nf_reqs') || '[]'),
    cfg: JSON.parse(localStorage.getItem('nf_cfg') || '{"daily":10,"streak":5,"msg":2,"boost":50,"sboost":150}')
};

function save() {
    localStorage.setItem('nf_users', JSON.stringify(DB.users));
    localStorage.setItem('nf_posts', JSON.stringify(DB.posts));
    localStorage.setItem('nf_reqs', JSON.stringify(DB.friendReqs));
    localStorage.setItem('nf_cfg', JSON.stringify(DB.cfg));
    if (me) localStorage.setItem('nf_session', me.id);
}

function load() {
    const sid = localStorage.getItem('nf_session');
    if (sid) me = DB.users.find(u => u.id === sid);
    render();
}

function age(d) {
    let b = new Date(d), t = new Date(), a = t.getFullYear() - b.getFullYear();
    if (t.getMonth() < b.getMonth() || (t.getMonth() === b.getMonth() && t.getDate() < b.getDate())) a--;
    return a;
}

function timeAgo(t) {
    const s = Math.floor((Date.now() - t) / 1000);
    if (s < 60) return 'Just now';
    if (s < 3600) return `${Math.floor(s / 60)}m`;
    if (s < 86400) return `${Math.floor(s / 3600)}h`;
    return `${Math.floor(s / 86400)}d`;
}

function signup(e) {
    e.preventDefault();
    const f = e.target;
    if (age(f.dob.value) < 18) return alert('18+ only');
    if (DB.users.find(u => u.email === f.email.value)) return alert('Email exists');
    
    const v = [];
    if (f.vibe_gamer.checked) v.push('gamer');
    if (f.vibe_stoner.checked) v.push('stoner');
    if (f.vibe_artist.checked) v.push('artist');
    if (f.vibe_nerd.checked) v.push('nerd');
    
    const isF = f.email.value.toLowerCase() === FE.toLowerCase();
    me = {
        id: 'u' + Date.now(),
        email: f.email.value,
        pw: btoa(f.password.value),
        name: f.name.value,
        dob: f.dob.value,
        age: age(f.dob.value),
        city: f.city.value,
        zip: f.zip.value || null,
        gender: f.gender.value,
        lookingFor: f.looking_for.value,
        vibes: v,
        bio: f.bio.value,
        badges: isF ? ['founder', 'welcome'] : ['welcome'],
        credits: 100,
        streak: 0,
        lastD: null,
        msgs: 0,
        admin: isF,
        founder: isF,
        status: 'active',
        joined: Date.now(),
        featured: f.consent_featured.checked,
        gamertags: [],
        friends: []
    };
    
    DB.users.push(me);
    save();
    alert('Welcome! üî• +100 credits' + (isF ? '\nüëë FOUNDER ACCESS!' : ''));
    render();
}

function login(e) {
    e.preventDefault();
    const f = e.target;
    const u = DB.users.find(x => x.email === f.email.value);
    if (!u || u.pw !== btoa(f.password.value)) return alert('Invalid');
    if (u.status === 'banned') return alert('Banned');
    me = u;
    save();
    
    // Daily reward
    const td = new Date().toDateString();
    if (me.lastD !== td) {
        const yd = new Date(Date.now() - 864e5).toDateString();
        me.streak = me.lastD === yd ? me.streak + 1 : 1;
        const r = DB.cfg.daily + (me.streak * DB.cfg.streak);
        me.credits += r;
        me.lastD = td;
        save();
        setTimeout(() => alert(`üéÅ +${r} credits!\nüî• ${me.streak} day streak!`), 200);
    }
    
    render();
}

function logout() {
    me = null;
    localStorage.removeItem('nf_session');
    render();
}

function createPost() {
    const content = document.getElementById('postContent').value.trim();
    if (!content) return;
    
    DB.posts.unshift({
        id: 'p' + Date.now(),
        userId: me.id,
        userName: me.name,
        content,
        likes: [],
        comments: [],
        created: Date.now()
    });
    
    me.msgs++;
    me.credits += DB.cfg.msg;
    save();
    document.getElementById('postContent').value = '';
    render();
}

function likePost(pid) {
    const p = DB.posts.find(x => x.id === pid);
    if (!p) return;
    if (p.likes.includes(me.id)) p.likes = p.likes.filter(x => x !== me.id);
    else p.likes.push(me.id);
    save();
    render();
}

function addComment(pid) {
    const input = document.getElementById('ci_' + pid);
    const content = input.value.trim();
    if (!content) return;
    
    const p = DB.posts.find(x => x.id === pid);
    if (!p) return;
    
    p.comments.push({
        id: 'c' + Date.now(),
        userId: me.id,
        userName: me.name,
        content,
        created: Date.now()
    });
    
    me.msgs++;
    me.credits += DB.cfg.msg;
    save();
    input.value = '';
    render();
}

function sendFriendReq(toId) {
    if (DB.friendReqs.find(r => r.from === me.id && r.to === toId && r.status === 'pending')) return alert('Already sent!');
    
    DB.friendReqs.push({
        id: 'fr' + Date.now(),
        from: me.id,
        to: toId,
        status: 'pending',
        time: Date.now()
    });
    save();
    alert('Friend request sent!');
    render();
}

function acceptFriend(reqId) {
    const req = DB.friendReqs.find(r => r.id === reqId);
    if (!req) return;
    
    req.status = 'accepted';
    if (!me.friends) me.friends = [];
    me.friends.push(req.from);
    
    const other = DB.users.find(u => u.id === req.from);
    if (other) {
        if (!other.friends) other.friends = [];
        other.friends.push(me.id);
    }
    
    me.credits += 10;
    save();
    alert('Friend added! +10 credits');
    render();
}

function render() {
    const app = document.getElementById('app');
    
    if (!me) {
        app.innerHTML = `
            <div class="landing">
                <div class="landing-content">
                    <div class="landing-left">
                        <h1 class="landing-logo">üî• NextFlame</h1>
                        <p class="landing-tagline">Connect with gamers, stoners, artists & nerds. Find your vibe, find your tribe.</p>
                    </div>
                    <div class="landing-right">
                        <div class="landing-card">
                            <h2>Join NextFlame</h2>
                            <p style="color:rgba(255,255,255,0.7);margin-bottom:20px">Dating & Friends for your community</p>
                            <button class="landing-btn" onclick="showAuth()">Get Started</button>
                            <div class="landing-features">
                                <div class="landing-feature">üí¨ Free messaging</div>
                                <div class="landing-feature">üéÆ Gamertags</div>
                                <div class="landing-feature">üèÜ Achievements</div>
                                <div class="landing-feature">üë• Make friends</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        return;
    }
    
    const friendReqs = DB.friendReqs.filter(r => r.to === me.id && r.status === 'pending');
    const discover = DB.users.filter(u => u.id !== me.id && u.status === 'active' && !(me.friends || []).includes(u.id)).slice(0, 5);
    
    app.innerHTML = `
        <div class="fb-layout">
            <!-- Top Nav -->
            <nav class="fb-topnav">
                <div class="fb-topnav-left">
                    <div class="fb-logo" onclick="view='feed';render()">üî• NextFlame</div>
                    <div class="fb-search"><input type="text" placeholder="Search NextFlame"></div>
                </div>
                <div class="fb-topnav-center">
                    <div class="fb-nav-icon ${view === 'feed' ? 'active' : ''}" onclick="view='feed';render()">
                        <span>üè†</span>
                    </div>
                    <div class="fb-nav-icon ${view === 'friends' ? 'active' : ''}" onclick="view='friends';render()">
                        <span>üë•</span>
                        ${friendReqs.length > 0 ? `<span class="fb-badge">${friendReqs.length}</span>` : ''}
                    </div>
                </div>
                <div class="fb-topnav-right">
                    <div class="fb-credits">ü™ô ${me.credits}</div>
                    <div class="fb-profile-menu">
                        <div class="fb-avatar">${me.name.charAt(0).toUpperCase()}</div>
                        <div class="fb-dropdown">
                            <div class="fb-dropdown-item" onclick="view='profile';render()">üë§ Profile</div>
                            <div class="fb-dropdown-item" onclick="view='dashboard';render()">üìä Dashboard</div>
                            ${me.admin ? '<div class="fb-dropdown-item" onclick="view=\'admin\';render()">üõ°Ô∏è Admin</div>' : ''}
                            <div class="fb-dropdown-item" onclick="logout()">üö™ Logout</div>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Main -->
            <div class="fb-main">
                <!-- Left Sidebar -->
                <div class="fb-sidebar-left">
                    <div class="fb-sidebar-item" onclick="view='feed';render()">
                        <span class="fb-sidebar-icon">üè†</span>
                        <span>News Feed</span>
                    </div>
                    <div class="fb-sidebar-item" onclick="view='profile';render()">
                        <span class="fb-sidebar-icon">üë§</span>
                        <span>${me.name}</span>
                    </div>
                    <div class="fb-sidebar-item" onclick="view='friends';render()">
                        <span class="fb-sidebar-icon">üë•</span>
                        <span>Friends</span>
                        ${friendReqs.length > 0 ? `<span class="fb-badge">${friendReqs.length}</span>` : ''}
                    </div>
                    <div class="fb-sidebar-item" onclick="view='dashboard';render()">
                        <span class="fb-sidebar-icon">üìä</span>
                        <span>Dashboard</span>
                    </div>
                    ${me.admin ? '<div class="fb-sidebar-item" onclick="view=\'admin\';render()"><span class="fb-sidebar-icon">üõ°Ô∏è</span><span>Admin Panel</span></div>' : ''}
                </div>
                
                <!-- Center Content -->
                <div class="fb-content">
                    ${renderView()}
                </div>
                
                <!-- Right Sidebar -->
                <div class="fb-sidebar-right">
                    <div class="fb-widget">
                        <h3>Friend Requests</h3>
                        ${friendReqs.length === 0 ? '<p style="color:rgba(255,255,255,0.5);font-size:13px">No new requests</p>' : friendReqs.map(req => {
                            const from = DB.users.find(u => u.id === req.from);
                            return `<div class="fb-friend-suggestion">
                                <div class="fb-avatar-sm">${from?.name?.charAt(0).toUpperCase()}</div>
                                <div style="flex:1">
                                    <div class="fb-friend-name">${from?.name}</div>
                                    <button class="fb-btn-primary" style="padding:4px 12px;font-size:12px;margin-top:4px" onclick="acceptFriend('${req.id}')">Accept</button>
                                </div>
                            </div>`;
                        }).join('')}
                    </div>
                    
                    <div class="fb-widget">
                        <h3>Discover People</h3>
                        ${discover.map(u => `<div class="fb-friend-suggestion">
                            <div class="fb-avatar-sm">${u.name.charAt(0).toUpperCase()}</div>
                            <div style="flex:1">
                                <div class="fb-friend-name">${u.name}</div>
                                <div style="font-size:11px;color:rgba(255,255,255,0.5)">${u.vibes.map(v => vi[v]).join(' ')}</div>
                                <button class="fb-btn-secondary" style="padding:4px 12px;font-size:12px;margin-top:4px" onclick="sendFriendReq('${u.id}')">Add Friend</button>
                            </div>
                        </div>`).join('')}
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderView() {
    if (view === 'feed') {
        return `
            <!-- Post Composer -->
            <div class="fb-card">
                <div class="fb-composer-top">
                    <div class="fb-avatar">${me.name.charAt(0).toUpperCase()}</div>
                    <textarea id="postContent" class="fb-composer-input" placeholder="What's on your mind, ${me.name}?"></textarea>
                </div>
                <div class="fb-composer-bottom">
                    <div style="display:flex;gap:16px;font-size:14px;color:rgba(255,255,255,0.7)">
                        <span>üé• Video</span>
                        <span>üì∏ Photo</span>
                    </div>
                    <button class="fb-btn-primary" onclick="createPost()">Post</button>
                </div>
            </div>
            
            <!-- Posts -->
            ${DB.posts.map(p => `
                <div class="fb-card fb-post">
                    <div class="fb-post-header">
                        <div class="fb-avatar">${p.userName.charAt(0).toUpperCase()}</div>
                        <div style="flex:1">
                            <div class="fb-post-author">${p.userName}</div>
                            <div class="fb-post-time">${timeAgo(p.created)}</div>
                        </div>
                    </div>
                    <div class="fb-post-content">${p.content}</div>
                    <div class="fb-post-stats">
                        <span>‚ù§Ô∏è ${p.likes.length}</span>
                        <span>üí¨ ${p.comments.length} comments</span>
                    </div>
                    <div class="fb-post-actions">
                        <button class="fb-post-action ${p.likes.includes(me.id) ? 'active' : ''}" onclick="likePost('${p.id}')">‚ù§Ô∏è Like</button>
                        <button class="fb-post-action">üí¨ Comment</button>
                    </div>
                    ${p.comments.length > 0 ? p.comments.map(c => `
                        <div class="fb-comment">
                            <div class="fb-avatar-sm">${c.userName.charAt(0).toUpperCase()}</div>
                            <div class="fb-comment-content">
                                <div class="fb-comment-author">${c.userName}</div>
                                <div class="fb-comment-text">${c.content}</div>
                            </div>
                        </div>
                    `).join('') : ''}
                    <div style="display:flex;gap:8px;padding-top:8px">
                        <div class="fb-avatar-sm">${me.name.charAt(0).toUpperCase()}</div>
                        <input id="ci_${p.id}" class="fb-comment-input" placeholder="Write a comment..." onkeypress="if(event.key==='Enter')addComment('${p.id}')">
                    </div>
                </div>
            `).join('') || '<div class="fb-card" style="text-align:center;padding:40px;color:rgba(255,255,255,0.5)">No posts yet. Be the first to share!</div>'}
        `;
    } else if (view === 'profile') {
        const myPosts = DB.posts.filter(p => p.userId === me.id);
        return `
            <div style="margin:-20px -16px 0">
                <div class="fb-cover"></div>
                <div class="fb-profile-header">
                    <div class="fb-profile-avatar">${me.name.charAt(0).toUpperCase()}</div>
                    <div class="fb-profile-info">
                        <h1>${me.name}, ${me.age}</h1>
                        <p style="color:rgba(255,255,255,0.7)">${me.bio}</p>
                        <div style="display:flex;gap:16px;font-size:14px;color:rgba(255,255,255,0.6);margin-top:8px">
                            <span>üìç ${me.city}</span>
                            <span>üë• ${(me.friends || []).length} friends</span>
                            <span>${me.vibes.map(v => vi[v]).join(' ')}</span>
                        </div>
                    </div>
                </div>
                <div class="fb-profile-tabs">
                    <div class="fb-profile-tab active">Posts</div>
                    <div class="fb-profile-tab">About</div>
                    <div class="fb-profile-tab">Friends</div>
                </div>
                <div style="padding:16px">
                    ${myPosts.map(p => `
                        <div class="fb-card">
                            <div class="fb-post-content">${p.content}</div>
                            <div class="fb-post-stats">
                                <span>‚ù§Ô∏è ${p.likes.length}</span>
                                <span>üí¨ ${p.comments.length}</span>
                            </div>
                        </div>
                    `).join('') || '<div class="fb-card" style="text-align:center;color:rgba(255,255,255,0.5)">No posts yet</div>'}
                </div>
            </div>
        `;
    } else if (view === 'friends') {
        const friendReqs = DB.friendReqs.filter(r => r.to === me.id && r.status === 'pending');
        const friends = DB.users.filter(u => (me.friends || []).includes(u.id));
        const discover = DB.users.filter(u => u.id !== me.id && u.status === 'active' && !(me.friends || []).includes(u.id));
        
        return `
            <h1 style="font-size:28px;margin-bottom:20px">Friends</h1>
            
            ${friendReqs.length > 0 ? `
                <div class="fb-card">
                    <h2 style="font-size:20px;margin-bottom:16px">Friend Requests (${friendReqs.length})</h2>
                    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px">
                        ${friendReqs.map(req => {
                            const from = DB.users.find(u => u.id === req.from);
                            return `<div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:16px;text-align:center">
                                <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 12px">${from?.name?.charAt(0).toUpperCase()}</div>
                                <div style="font-weight:600;margin-bottom:8px">${from?.name}</div>
                                <button class="fb-btn-primary" style="width:100%;margin-bottom:6px" onclick="acceptFriend('${req.id}')">Accept</button>
                            </div>`;
                        }).join('')}
                    </div>
                </div>
            ` : ''}
            
            <div class="fb-card">
                <h2 style="font-size:20px;margin-bottom:16px">All Friends (${friends.length})</h2>
                ${friends.length > 0 ? `
                    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px">
                        ${friends.map(f => `<div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:16px;text-align:center">
                            <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 12px">${f.name.charAt(0).toUpperCase()}</div>
                            <div style="font-weight:600">${f.name}</div>
                        </div>`).join('')}
                    </div>
                ` : '<p style="text-align:center;color:rgba(255,255,255,0.5);padding:20px">No friends yet</p>'}
            </div>
            
            <div class="fb-card">
                <h2 style="font-size:20px;margin-bottom:16px">People You May Know</h2>
                <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px">
                    ${discover.slice(0, 12).map(u => `<div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:16px;text-align:center">
                        <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 12px">${u.name.charAt(0).toUpperCase()}</div>
                        <div style="font-weight:600;margin-bottom:4px">${u.name}</div>
                        <div style="font-size:12px;color:rgba(255,255,255,0.5);margin-bottom:8px">${u.vibes.map(v => vi[v]).join(' ')}</div>
                        <button class="fb-btn-primary" style="width:100%" onclick="sendFriendReq('${u.id}')">Add Friend</button>
                    </div>`).join('')}
                </div>
            </div>
        `;
    } else if (view === 'dashboard') {
        const nx = DB.cfg.daily + ((me.streak + 1) * DB.cfg.streak);
        return `
            <h1 style="font-size:28px;margin-bottom:20px">Dashboard</h1>
            
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-bottom:16px">
                <div class="fb-card" style="text-align:center;background:linear-gradient(135deg,rgba(255,215,0,0.1),rgba(255,140,0,0.1));border-color:rgba(255,215,0,0.3)">
                    <h3>üéÅ Daily Reward</h3>
                    <div style="font-size:36px;font-weight:bold;margin:16px 0">üî• ${me.streak} Days</div>
                    <p style="font-size:13px">Tomorrow: +${nx} credits</p>
                </div>
                
                <div class="fb-card" style="text-align:center">
                    <h3>ü™ô Credits</h3>
                    <div style="font-size:48px;font-weight:bold;margin:16px 0;background:linear-gradient(135deg,#ffd700,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent">${me.credits}</div>
                    <p style="font-size:12px;color:rgba(255,255,255,0.5)">+${DB.cfg.msg} per message</p>
                </div>
            </div>
            
            <div class="fb-card">
                <h3 style="margin-bottom:16px">üíé Subscriptions</h3>
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">
                    <div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:20px;text-align:center">
                        <h4 style="color:#f5576c;margin-bottom:8px">Connect</h4>
                        <div style="font-size:28px;font-weight:bold">$3.99</div>
                        <p style="font-size:12px;margin:8px 0">+200 credits/mo</p>
                        <button class="fb-btn-secondary" style="width:100%;margin-top:8px">Learn More</button>
                    </div>
                    <div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:20px;text-align:center">
                        <h4 style="color:#f5576c;margin-bottom:8px">Plus</h4>
                        <div style="font-size:28px;font-weight:bold">$8.99</div>
                        <p style="font-size:12px;margin:8px 0">+500 credits/mo</p>
                        <button class="fb-btn-secondary" style="width:100%;margin-top:8px">Learn More</button>
                    </div>
                    <div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:20px;text-align:center">
                        <h4 style="color:#f5576c;margin-bottom:8px">Premium</h4>
                        <div style="font-size:28px;font-weight:bold">$19.99</div>
                        <p style="font-size:12px;margin:8px 0">+1500 credits/mo</p>
                        <button class="fb-btn-secondary" style="width:100%;margin-top:8px">Learn More</button>
                    </div>
                </div>
            </div>
        `;
    } else if (view === 'admin' && me.admin) {
        return `
            <h1 style="font-size:28px;margin-bottom:20px">üõ°Ô∏è Admin Panel</h1>
            <div class="fb-card">
                <h3>Users (${DB.users.length})</h3>
                <p style="color:rgba(255,255,255,0.7);margin-top:8px">Manage all platform users</p>
            </div>
        `;
    }
    return '';
}

function showAuth() {
    document.getElementById('app').innerHTML += `
        <div class="modal" onclick="if(event.target===this)this.remove()">
            <div class="modal-content">
                <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                <h2>Join NextFlame</h2>
                <form onsubmit="signup(event);this.closest('.modal').remove()">
                    <div class="form-row">
                        <input name="name" placeholder="Name" required>
                        <input name="email" type="email" placeholder="Email" required>
                    </div>
                    <div class="form-row">
                        <input name="password" type="password" placeholder="Password (8+)" required minlength="8">
                        <input name="dob" type="date" required>
                    </div>
                    <div class="form-row">
                        <input name="city" placeholder="City" required>
                        <input name="zip" placeholder="ZIP (optional)">
                    </div>
                    <div class="form-row">
                        <select name="gender" required>
                            <option value="">I'm a...</option>
                            <option>Man</option>
                            <option>Woman</option>
                            <option>Non-binary</option>
                        </select>
                        <select name="looking_for" required>
                            <option value="">Looking for...</option>
                            <option value="dating">üíï Dating</option>
                            <option value="friends">üë• Friends</option>
                            <option value="both">üíïüë• Both</option>
                        </select>
                    </div>
                    <div style="display:flex;gap:16px;margin-bottom:12px;font-size:14px">
                        <label><input type="checkbox" name="vibe_gamer"> üéÆ Gamer</label>
                        <label><input type="checkbox" name="vibe_stoner"> üåø Stoner</label>
                        <label><input type="checkbox" name="vibe_artist"> üé® Artist</label>
                        <label><input type="checkbox" name="vibe_nerd"> ü§ì Nerd</label>
                    </div>
                    <textarea name="bio" placeholder="Bio (50+ chars)" required minlength="50" rows="3"></textarea>
                    <label style="display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:14px">
                        <input type="checkbox" name="consent_featured">
                        <span>Feature me on homepage</span>
                    </label>
                    <button type="submit" class="fb-btn-primary" style="width:100%;padding:12px">Sign Up</button>
                    <p style="text-align:center;margin-top:16px;font-size:14px;color:rgba(255,255,255,0.7)">
                        Have an account? <button type="button" style="background:none;border:none;color:#f5576c;text-decoration:underline;cursor:pointer" onclick="showLogin()">Log In</button>
                    </p>
                </form>
            </div>
        </div>
    `;
}

function showLogin() {
    document.querySelectorAll('.modal').forEach(m => m.remove());
    document.getElementById('app').innerHTML += `
        <div class="modal" onclick="if(event.target===this)this.remove()">
            <div class="modal-content">
                <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                <h2>Log In to NextFlame</h2>
                <form onsubmit="login(event);this.closest('.modal').remove()">
                    <input name="email" type="email" placeholder="Email" required>
                    <input name="password" type="password" placeholder="Password" required>
                    <button type="submit" class="fb-btn-primary" style="width:100%;padding:12px">Log In</button>
                    <p style="text-align:center;margin-top:16px;font-size:14px;color:rgba(255,255,255,0.7)">
                        Don't have an account? <button type="button" style="background:none;border:none;color:#f5576c;text-decoration:underline;cursor:pointer" onclick="showAuth()">Sign Up</button>
                    </p>
                </form>
            </div>
        </div>
    `;
}

// Initialize
load();
</script>
</body>
</html>
